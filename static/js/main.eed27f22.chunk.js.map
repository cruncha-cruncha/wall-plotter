{"version":3,"sources":["components/ImageHandler/state/atoms.js","components/ImageHandler/ImageHandler.js","components/ImageHandler/useImageHandler.js","components/SpecInputs/state/atoms.js","components/SpecInputs/components/InputRow.js","components/SpecInputs/SpecInputs.js","components/SpecInputs/useSpecInputs.js","components/Converter/state/atoms.js","components/Converter/state/coorErrors.js","components/Converter/state/coorsReady.js","components/Converter/helpers/solveCoors.js","components/Converter/state/realCoors.js","components/Converter/state/specErrors.js","components/Converter/state/specsReady.js","components/Converter/useConverter.js","components/Converter/Converter.js","components/Preview/Preview.js","components/Preview/usePreview.js","components/ConversionProgress/ConversionProgress.js","components/ConversionProgress/useConversionProgress.js","App.js","reportWebVitals.js","index.js"],"names":["fileContentState","atom","key","default","ImageHandler","setFileContent","useSetRecoilState","useState","file","setFile","className","Label","for","Input","type","id","accept","onChange","e","newFile","URL","createObjectURL","target","files","reader","FileReader","onload","result","readAsText","style","border","height","minWidth","overflowY","src","width","alt","specsState","InputRow","label","actionType","specs","dispatch","step","value","payload","SpecInputs","useRecoilState","setSpecs","action","useSpecInputs","FormGroup","tag","check","checked","progressState","downloadBlobState","BOUNDS","upper","lower","coorErrorsState","selector","get","fileContent","specsAlpha","msg","Object","keys","reduce","out","k","Number","spec","coorsReadyState","solveCoors","eyeToEye","toolOffsetX","toolOffsetY","leftLength","rightLength","n1","n2","Math","pow","a","c","leftY2","sqrt","x","y","realCoorsState","ready","mmToCm","mm","dom","DOMParser","parseFromString","mySvg","Array","from","querySelectorAll","getAttribute","getViewBoxNums","unitToMm","unit","spoolRadius","leftEye","rightEye","leftLine","start","end","rightLine","outputRect","totalWidth","totalHeight","coors","isNaN","rightY2","leftX2","rightX2","alert","specErrorsState","realCoors","specsReadyState","viewBox","split","includes","map","val","trim","Converter","setProgress","useRecoilValue","specsReady","specErrors","coorErrors","downloadBlob","setDownloadBlob","downloadHref","setDownloadHref","cmToMm","cm","go","progress","updateProgress","push","Promise","resolve","setTimeout","parser","querySelector","myPaths","length","i","round","getTotalLength","mmToUnit","pointToCoor","point","distToLine","coorA","coorB","coorC","abs","getSpeed","b","dist","eD","pathToCoors","path","total","speed","coor","getPointAtLength","resolutionCoor","resolution","lag","precision","newCoor","finalCoor","getPulses","actualLeftSteps","leftDirection","actualRightSteps","rightDirection","speeds","mostSteps","max","leftModulus","rightModulus","fill","s","l","r","current","top","eventual","forEach","o","speedDiff","sign","blockSize","halfway","firstBaseSpeed","firstSpeedDiff","firstSign","firstBlockSize","secondBaseSpeed","secondSpeedDiff","secondSign","secondBlockSize","leftSum","rightSum","mmPerStep","PI","stepsPerMm","traverseStraight","desired","nextSpeed","currentLeftCoor","desiredLeftCoor","currentRightCoor","desiredRightCoor","leftDelta","rightDelta","newLeftLength","newRightLength","pulses","min","newCurrent","masterCoors","t1","Date","now","t2","bigPulseList","stepsPerSecond","Blob","JSON","stringify","useEffect","useConverter","Button","disabled","onClick","href","download","Preview","svg","setSvg","newSvg","version","xmlns","x1","y1","x2","y2","stroke","strokeWidth","cx","cy","usePreview","ConversionProgress","padding","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.eed27f22.chunk.js","sourcesContent":["import { atom } from 'recoil';\r\n\r\nexport const fileContentState = atom({\r\n  key: 'fileContents',\r\n  default: ''\r\n});","import React, { useState } from 'react';\r\nimport { Label, Input } from 'reactstrap';\r\n\r\nimport useImageHandler from './useImageHandler';\r\n\r\nfunction ImageHandler() {\r\n  const { setFileContent } = useImageHandler();\r\n  const [file, setFile] = useState(null);\r\n\r\n  const handleChange = (e) => {\r\n    const newFile = URL.createObjectURL(e.target.files[0]);\r\n    setFile(newFile);\r\n\r\n    const reader = new FileReader();\r\n    reader.onload = () => { setFileContent(reader.result); };\r\n    reader.readAsText(e.target.files[0]);\r\n  }\r\n\r\n  return (\r\n    <div className=\"mb-4\">\r\n      <div className=\"mb-3\">\r\n        <Label for=\"select-svg-input\">Select an SVG</Label>\r\n        <Input type=\"file\" id=\"select-svg-input\" accept=\".svg\" onChange={handleChange} />\r\n      </div>\r\n      <div className=\"d-flex\">\r\n        <div style={{ border: '1px solid black', height: \"402px\", minWidth: \"402px\", overflowY: \"scroll\" }} >\r\n          {file && <img src={file} width=\"400\" alt=\"selected img\" />}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ImageHandler;","import { useSetRecoilState } from 'recoil';\r\n\r\nimport { fileContentState } from './state';\r\n\r\nexport default function useImageHandler() {\r\n  const setFileContent = useSetRecoilState(fileContentState);\r\n\r\n  return {\r\n    setFileContent\r\n  };\r\n}","import { atom } from 'recoil';\r\n\r\nexport const specsState = atom({\r\n  key: \"specs\",\r\n  default: {\r\n    'step-resolution': '0.225',\r\n    'final-height': '20',\r\n    'spool-radius': '2',\r\n    'eye-to-eye': '101',\r\n    'specify-start-by-coors': true,\r\n    'initial-length-left': '42',\r\n    'initial-length-right': '124',\r\n    'initial-coors-x': '42',\r\n    'initial-coors-y': '58',\r\n    'tool-offset-x': '3',\r\n    'tool-offset-y': '2'\r\n  }\r\n});","import React from 'react';\r\nimport { Label, Input } from 'reactstrap';\r\n\r\nconst InputRow = ({ label, actionType, specs, dispatch }) => {\r\n\r\n  const fV = (val) => val; //Number(val).toString();\r\n\r\n  return (\r\n    <div className=\"row mb-3\">\r\n      <div className=\"col-6 d-flex flex-row align-items-center\">\r\n        <Input id={actionType} type=\"number\" step=\"any\" value={fV(specs[actionType])} onChange={(e) => dispatch({ type: actionType, payload: e.target.value })} />\r\n      </div>\r\n      <div className=\"col-6 d-flex flex-row align-items-center\">\r\n        <Label for={actionType}>{label}</Label>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default InputRow;","import React, { Fragment } from 'react';\r\nimport { FormGroup, Label, Input } from 'reactstrap';\r\n\r\nimport useSpecInputs from './useSpecInputs';\r\nimport InputRow from './components/InputRow';\r\n\r\nconst SpecInputs = () => {\r\n\r\n  const { specs, dispatch } = useSpecInputs();\r\n\r\n  return (\r\n    <div className=\"specifications\">\r\n      <h2>Specifications</h2>\r\n      <p>All values in cms unless otherwise specified.</p>\r\n      <InputRow label=\"Step Resolution (degrees)\" actionType='step-resolution' specs={specs} dispatch={dispatch} />\r\n      <InputRow label=\"Output Height\" actionType='final-height' specs={specs} dispatch={dispatch} />\r\n      <InputRow label=\"Spool Radius\" actionType='spool-radius' specs={specs} dispatch={dispatch} />\r\n      <InputRow label=\"Eye-To-Eye\" actionType='eye-to-eye' specs={specs} dispatch={dispatch} />\r\n      <p>It's assumed that the plotter uses two strings, each with one end wound around a spool, travelling through an eye, and the other attached to a symmetrical tool holder. The program will start drawing from the upper-left corner of the image.</p>\r\n      <FormGroup tag=\"fieldset\">\r\n        <legend>Initial Position</legend>\r\n        <FormGroup check>\r\n          <Label check>\r\n            <Input\r\n              type=\"radio\"\r\n              onChange={() => dispatch({ type: 'specify-start-by-coors', payload: false })}\r\n              checked={!specs['specify-start-by-coors']}/>{' '}\r\n            Specify by distance from eyes\r\n          </Label>\r\n        </FormGroup>\r\n        <FormGroup check>\r\n          <Label check>\r\n            <Input\r\n              type=\"radio\"\r\n              onChange={() => dispatch({ type: 'specify-start-by-coors', payload: true })}\r\n              checked={specs['specify-start-by-coors']}/>{' '}\r\n            Specify by horizontal and vertical offset\r\n          </Label>\r\n        </FormGroup>\r\n      </FormGroup>\r\n      {specs['specify-start-by-coors'] \r\n        ? (\r\n          <Fragment>\r\n            <p>Measure from the center of the left eye to the top left corner of the desired image location.</p>\r\n            <InputRow label=\"Horizontal Offset\" actionType='initial-coors-x' specs={specs} dispatch={dispatch} />\r\n            <InputRow label=\"Vertical Offset\" actionType='initial-coors-y' specs={specs} dispatch={dispatch} />\r\n          </Fragment>)\r\n        : (\r\n          <Fragment>\r\n            <p>Measure from either the left or right eye to the corresponding tool holder terminus (where the string connects).</p>\r\n            <InputRow label=\"Left, initial distance\" actionType='initial-length-left' specs={specs} dispatch={dispatch} />\r\n            <InputRow label=\"Right, initial distance\" actionType='initial-length-right' specs={specs} dispatch={dispatch} />\r\n          </Fragment>)}\r\n      <p>The left terminus is assumed to be above and to the left of the tool, while the right terminus is assumed to be above and to the right of the tool. \"Horizontal Terminus Offset\" is the horizontal distance between a terminus and the tool tip (it should be the same for both termini); \"Vertical Terminus Offset\" is the vertical distance between a terminus and the tool tip (should also be the same for both).</p>\r\n      <InputRow label=\"Horizontal Terminus Offset\" actionType='tool-offset-x' specs={specs} dispatch={dispatch} />\r\n      <InputRow label=\"Vertical Terminus Offset\" actionType='tool-offset-y' specs={specs} dispatch={dispatch} />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default SpecInputs;","import { useRecoilState } from 'recoil';\r\n\r\nimport { specsState } from './state';\r\n\r\nexport default function useSpecInputs() {\r\n  const [ specs, setSpecs ] = useRecoilState(specsState);\r\n\r\n  const dispatch = (action) => {\r\n    setSpecs({\r\n      ...specs,\r\n      [action.type]: action.payload\r\n    });\r\n  }\r\n\r\n  return {\r\n    specs,\r\n    dispatch\r\n  }\r\n}","import { atom } from 'recoil';\r\n\r\nexport const progressState = atom({\r\n  key: 'progress',\r\n  default: []\r\n});\r\n\r\nexport const downloadBlobState = atom({\r\n  key: 'downloadBload',\r\n  default: null\r\n})","import { selector } from 'recoil';\r\n\r\nimport { fileContentState } from '../../ImageHandler/state';\r\nimport { specsState } from '../../SpecInputs/state';\r\n\r\nexport const BOUNDS = {\r\n  'final-height': {\r\n    upper: 1000,\r\n    lower: 1\r\n  },\r\n  'eye-to-eye': {\r\n    upper: 1000,\r\n    lower: 1\r\n  },\r\n  'spool-radius': {\r\n    upper: 25,\r\n    lower: 0\r\n  },\r\n  'initial-length-left': {\r\n    upper: 1000,\r\n    lower: 0\r\n  },\r\n  'initial-length-right': {\r\n    upper: 1000,\r\n    lower: 0\r\n  },\r\n  'initial-coors-x': {\r\n    upper: 1000,\r\n    lower: 0\r\n  },\r\n  'initial-coors-y': {\r\n    upper: 1000,\r\n    lower: 0\r\n  },\r\n  'tool-offset-x': {\r\n    upper: 50,\r\n    lower: 0\r\n  },\r\n  'tool-offset-y': {\r\n    upper: 50,\r\n    lower: 0\r\n  }\r\n}\r\n\r\nexport const coorErrorsState = selector({\r\n  key: 'coorErrors',\r\n  get: ({get}) => {\r\n    const fileContent = get(fileContentState);\r\n    const specsAlpha = get(specsState);\r\n\r\n    // do we have a file and specs?\r\n    if (!fileContent || !specsAlpha) {\r\n      return { msg: 'No image' };\r\n    }\r\n\r\n    const specs = Object.keys(specsAlpha).reduce((out, k) => ({\r\n      ...out,\r\n      [k]: Number(specsAlpha[k])\r\n    }), {});\r\n\r\n    // have spec values been entered?\r\n    for (let k of Object.keys(BOUNDS)) {\r\n      if (!(k in specs)) {\r\n        return { spec: k, msg: `Missing ${k} specification` };\r\n      }\r\n    }\r\n\r\n    // are all spec values within a reasonable range? (lower bounds)\r\n    for (let k of Object.keys(BOUNDS)) {\r\n      if (specs[k] > BOUNDS[k].upper) {\r\n        return { spec: k, msg: `${k} is too high; max is ${BOUNDS[k].upper}` };\r\n      } else if (specs[k] < BOUNDS[k].lower) {\r\n        return { spec: k, msg: `${k} is too low; minimum is ${BOUNDS[k].lower}` };\r\n      }\r\n    }\r\n\r\n    // is the initial position physically valid?\r\n    if (specs['specify-start-by-coors']) {\r\n      if (\r\n        specs['initial-coors-x'] +\r\n        (specs['tool-offset-x'] * 2) >\r\n        specs['eye-to-eye']\r\n      ) {\r\n        return { msg: 'Specs are not physically valid' };\r\n      }\r\n    }\r\n\r\n    return null;\r\n  },\r\n});","import { selector } from 'recoil';\r\n\r\nimport { coorErrorsState } from './coorErrors';\r\n\r\nexport const coorsReadyState = selector({\r\n  key: 'coorsReady',\r\n  get: ({get}) => {\r\n    const errors = get(coorErrorsState);\r\n    return !errors;\r\n  },\r\n});","// eyeToEye = sqrt(leftLength^2 - y^2) + (toolOffsetX * 2) + sqrt(rightLength^2 - y^2)\r\n// solve for y\r\n\r\nexport default function solveCoors({ eyeToEye, toolOffsetX, toolOffsetY, leftLength, rightLength }) {\r\n  if (eyeToEye <= 0 || toolOffsetX < 0 || toolOffsetY < 0 || leftLength < 0 || rightLength < 0) {\r\n    return null;\r\n  }\r\n\r\n  const n1 = eyeToEye - (toolOffsetX * 2);\r\n  const n2 = Math.pow(rightLength, 2) - Math.pow(leftLength, 2) - Math.pow(n1, 2);\r\n\r\n  const a = 4 * Math.pow(n1, 2);\r\n  // b is always zero\r\n  const c = -4 * Math.pow(n1, 2) * Math.pow(leftLength, 2) + Math.pow(n2, 2);\r\n\r\n  const leftY2 = Math.sqrt(-4 * a * c) / (2 * a);\r\n  const leftX2 = Math.sqrt(Math.pow(leftLength, 2) - Math.pow(leftY2, 2));\r\n\r\n  return {\r\n    x: leftX2 + toolOffsetX,\r\n    y: leftY2 + toolOffsetY\r\n  };\r\n}","import { selector } from 'recoil';\r\n\r\nimport { fileContentState } from '../../ImageHandler/state';\r\nimport { specsState } from '../../SpecInputs/state';\r\nimport { coorsReadyState } from './coorsReady';\r\n\r\nimport solveCoors from '../helpers/solveCoors';\r\n\r\nimport { getViewBoxNums } from '../useConverter';\r\n\r\nexport const realCoorsState = selector({\r\n  key: 'realCoors',\r\n  get: ({get}) => {\r\n    const ready = get(coorsReadyState);\r\n    const specsAlpha = get(specsState);\r\n    const fileContent = get(fileContentState);\r\n\r\n    if (!ready) {\r\n      return null;\r\n    }\r\n\r\n    const specs = Object.keys(specsAlpha).reduce((out, k) => ({\r\n      ...out,\r\n      [k]: Number(specsAlpha[k])\r\n    }), {});\r\n\r\n    const mmToCm = (mm) => mm / 10;\r\n    const cmToMm = (cm) => cm * 10;\r\n\r\n    const parser = new DOMParser();\r\n    const dom = parser.parseFromString(fileContent, \"application/xml\");\r\n\r\n    const mySvg = Array.from(dom.querySelectorAll(\"svg\"))[0];\r\n    if (!mySvg.getAttribute(\"viewBox\")) {\r\n      alert(\"SVG needs a viewBox\");\r\n      return;\r\n    }\r\n\r\n    const [_minX, _minY, width, height] = getViewBoxNums(mySvg.getAttribute(\"viewBox\"));\r\n\r\n    const unitToMm = (unit) => unit * cmToMm(specs[\"final-height\"]) / height;\r\n\r\n    if (specs['specify-start-by-coors']) {\r\n      return {\r\n        spoolRadius: specs['spool-radius'],\r\n        leftEye: { x: 0, y: 0 },\r\n        rightEye: { x: specs['eye-to-eye'], y: 0 },\r\n        leftLine: {\r\n          start: { x: 0, y: 0 },\r\n          end: {\r\n            x: specs['initial-coors-x'] - specs['tool-offset-x'],\r\n            y: specs['initial-coors-y'] - specs['tool-offset-y'] }\r\n        },\r\n        rightLine: {\r\n          start: { x: specs['eye-to-eye'], y: 0 },\r\n          end: {\r\n            x: specs['initial-coors-x'] + specs['tool-offset-x'],\r\n            y: specs['initial-coors-y'] - specs['tool-offset-y']\r\n          }\r\n        },\r\n        outputRect: {\r\n          x: specs['initial-coors-x'],\r\n          y: specs['initial-coors-y'],\r\n          width: mmToCm(unitToMm(width)),\r\n          height: mmToCm(unitToMm(height))\r\n        },\r\n        totalWidth: specs['eye-to-eye'],\r\n        totalHeight: specs['initial-coors-y'] + mmToCm(unitToMm(height))\r\n      }\r\n    } else {\r\n      const coors = solveCoors({\r\n        eyeToEye: specs['eye-to-eye'],\r\n        toolOffsetX: specs['tool-offset-x'],\r\n        toolOffsetY: specs['tool-offset-y'],\r\n        leftLength: specs['initial-length-left'],\r\n        rightLength: specs['initial-length-right'],\r\n      });\r\n\r\n      if (!coors) {\r\n        return null;\r\n      }\r\n\r\n      if (isNaN(coors.x) || isNaN(coors.y)) {\r\n        return null;\r\n      }\r\n\r\n      const leftY2 = coors.y - specs['tool-offset-y'];\r\n      const rightY2 = leftY2;\r\n      const leftX2 = coors.x - specs['tool-offset-x'];\r\n      const rightX2 = coors.x + specs['tool-offset-x'];\r\n\r\n      return {\r\n        spoolRadius: specs['spool-radius'],\r\n        leftEye: { x: 0, y: 0 },\r\n        rightEye: { x: specs['eye-to-eye'], y: 0 },\r\n        leftLine: {\r\n          start: { x: 0, y: 0 },\r\n          end: { x: leftX2, y: leftY2 }\r\n        },\r\n        rightLine: {\r\n          start: { x: specs['eye-to-eye'], y: 0 },\r\n          end: { x: rightX2, y: rightY2 }\r\n        },\r\n        outputRect: {\r\n          x: leftX2 + specs['tool-offset-x'],\r\n          y: leftY2 + specs['tool-offset-y'],\r\n          width: mmToCm(unitToMm(width)),\r\n          height: mmToCm(unitToMm(height))\r\n        },\r\n        totalWidth: specs['eye-to-eye'],\r\n        totalHeight: leftY2 + specs['tool-offset-y'] + mmToCm(unitToMm(height))\r\n      }\r\n    } \r\n  }\r\n});","import { selector } from 'recoil';\r\n\r\nimport { specsState } from '../../SpecInputs/state';\r\nimport { realCoorsState } from './realCoors';\r\n\r\nexport const BOUNDS = {\r\n  'step-resolution': {\r\n    upper: 45,\r\n    lower: 0.01\r\n  },\r\n}\r\n\r\nexport const specErrorsState = selector({\r\n  key: 'specErrors',\r\n  get: ({get}) => {\r\n    const realCoors = get(realCoorsState);\r\n    const specsAlpha = get(specsState);\r\n\r\n    if (!realCoors) {\r\n      return { msg: 'Specs are not physically valid' };\r\n    } else if (realCoors.outputRect.x + realCoors.outputRect.width > realCoors.rightEye.x) {\r\n      return { msg: 'Can\\'t draw outside vertical bounds of eyes' };\r\n    }\r\n\r\n    const specs = Object.keys(specsAlpha).reduce((out, k) => ({\r\n      ...out,\r\n      [k]: Number(specsAlpha[k])\r\n    }), {});\r\n\r\n    // have spec values been entered?\r\n    for (let k of Object.keys(BOUNDS)) {\r\n      if (!(k in specs)) {\r\n        return { spec: k, msg: `Missing ${k} specification` };\r\n      }\r\n    }\r\n\r\n    // are all spec values within a reasonable range? (lower bounds)\r\n    for (let k of Object.keys(BOUNDS)) {\r\n      if (specs[k] > BOUNDS[k].upper) {\r\n        return { spec: k, msg: `${k} is too high; max is ${BOUNDS[k].upper}` };\r\n      } else if (specs[k] < BOUNDS[k].lower) {\r\n        return { spec: k, msg: `${k} is too low; minimum is ${BOUNDS[k].lower}` };\r\n      }\r\n    }\r\n\r\n    return null;\r\n  },\r\n});","import { selector } from 'recoil';\r\n\r\nimport { specErrorsState } from './specErrors';\r\n\r\nexport const specsReadyState = selector({\r\n  key: 'specsReady',\r\n  get: ({get}) => {\r\n    const errors = get(specErrorsState);\r\n    return !errors;\r\n  },\r\n});","import { useState, useEffect } from 'react';\r\nimport { useRecoilState, useRecoilValue, useSetRecoilState } from 'recoil';\r\n\r\nimport { fileContentState } from '../ImageHandler/state';\r\nimport { specsState } from '../SpecInputs/state';\r\nimport { progressState, specErrorsState, specsReadyState, coorErrorsState, realCoorsState, downloadBlobState } from './state';\r\n\r\nimport solveCoors from './helpers/solveCoors';\r\n\r\nexport const getViewBoxNums = viewBox => viewBox.split(viewBox.includes(',') ? \",\" : \" \").map(val => Number(val.trim()));\r\n\r\nexport default function useConverter() {\r\n  const setProgress = useSetRecoilState(progressState);\r\n  const specsAlpha = useRecoilValue(specsState);\r\n  const fileContent = useRecoilValue(fileContentState);\r\n  const specsReady = useRecoilValue(specsReadyState);\r\n  const specErrors = useRecoilValue(specErrorsState);\r\n  const coorErrors = useRecoilValue(coorErrorsState);\r\n  const realCoors = useRecoilValue(realCoorsState);\r\n  const [downloadBlob, setDownloadBlob] = useRecoilState(downloadBlobState);\r\n  const [downloadHref, setDownloadHref] = useState('');\r\n  \r\n  const mmToCm = (mm) => mm / 10;\r\n  const mmToM = (mm) => mm / 1000;\r\n  const cmToMm = (cm) => cm * 10;\r\n  const cmToM = (cm) => cm / 100;\r\n  const mToMm = (m) => m * 1000;\r\n  const mToCm = (m) => m * 100;\r\n\r\n  const go = async () => {\r\n    if (specsReady) {\r\n      const specs = Object.keys(specsAlpha).reduce((out, k) => ({\r\n        ...out,\r\n        [k]: Number(specsAlpha[k])\r\n      }), {});\r\n\r\n      setProgress([]);\r\n      const progress = [];\r\n      const updateProgress = async (msg) => {\r\n        progress.push(msg);\r\n        setProgress([ ...progress ]);\r\n        // give progress a chance to propogate\r\n        await new Promise((resolve) => setTimeout(resolve, 0));\r\n      }\r\n\r\n      setDownloadHref('');\r\n\r\n      // ---- Get SVG, it's dimensions and paths ----\r\n      const parser = new DOMParser();\r\n      const dom = parser.parseFromString(fileContent, \"application/xml\");\r\n\r\n      const mySvg = dom.querySelector(\"svg\");\r\n      const [_minX, _minY, _width, height] = getViewBoxNums(mySvg.getAttribute(\"viewBox\"));\r\n\r\n      // in future, also get: circle, ellipse, line, mesh, path, polygon, polyline, rect?\r\n      const myPaths = Array.from(dom.querySelectorAll(\"path\"));\r\n      await updateProgress(`Found ${myPaths.length} paths, of lengths:`);\r\n      for (let i = 0; i < myPaths.length; i++) {\r\n        await updateProgress(`${i}: ${Math.round(myPaths[i].getTotalLength() * 100) / 100}`);\r\n      }     \r\n      \r\n      // ---- Define functions for converting SVG coors into real-world coors ----\r\n      const unitToMm = (unit) => unit * cmToMm(specs[\"final-height\"]) / height;\r\n      const mmToUnit = (mm) => mm * height / cmToMm(specs[\"final-height\"]);\r\n\r\n      const pointToCoor = (point) => ({\r\n        x: cmToMm(realCoors.outputRect.x) + unitToMm(point.x),\r\n        y: cmToMm(realCoors.outputRect.y) + unitToMm(point.y)\r\n      });\r\n\r\n      // how far away is coorB from a line passing through coorA and coorC\r\n      const distToLine = (coorA, coorB, coorC) => {\r\n        return (\r\n          Math.abs((coorC.x - coorA.x) * (coorA.y - coorB.y) - (coorA.x - coorB.x) * (coorC.y - coorA.y)) /\r\n          Math.sqrt(Math.pow((coorC.x - coorA.x), 2) + Math.pow((coorC.y - coorA.y), 2))\r\n        );\r\n      }\r\n\r\n      // jerk mitigation: 7 = fastest, 0 = slowest\r\n      const getSpeed = ( a, b ) => {\r\n        const dist = eD(a,b);\r\n        if (dist >= 20) {\r\n          return 7;\r\n        } else if (dist >= 10) {\r\n          return 5;\r\n        } else if (dist >= 5) {\r\n          return 3;\r\n        } else if (dist >= 3) {\r\n          return 2;\r\n        } else if (dist >= 1) {\r\n          return 1;\r\n        } else {\r\n          return 0;\r\n        }\r\n      }\r\n\r\n      const pathToCoors = (path) => {\r\n        const out = [];\r\n        const total = unitToMm(path.getTotalLength());\r\n\r\n        // use 2mm output resolution\r\n        const resolution = 2;\r\n\r\n        out.push({\r\n          speed: 0,\r\n          coor: pointToCoor(path.getPointAtLength(0))\r\n        });\r\n\r\n        if (total > resolution) {\r\n\r\n          const resolutionCoor = pointToCoor(path.getPointAtLength(mmToUnit(resolution)));\r\n          out.push({\r\n            speed: getSpeed( out[0].coor, resolutionCoor ),\r\n            coor: resolutionCoor\r\n          });\r\n\r\n          if (total > resolution * 2) {\r\n            let lag = 0;\r\n            let mm = resolution * 2; \r\n            let precision = resolution;\r\n\r\n            while (mm < total) {\r\n              const newCoor = pointToCoor(path.getPointAtLength(mmToUnit(mm)))\r\n              const dist = distToLine(out[lag], out[lag+1], newCoor);\r\n\r\n              if (dist < precision) {\r\n                out[lag+1] = { speed: getSpeed( out[lag].coor, newCoor ), coor: newCoor };\r\n                precision = precision / 2;\r\n              } else {\r\n                lag += 1;\r\n                out.push({ speed: getSpeed( out[lag].coor, newCoor), coor: newCoor });\r\n                precision = resolution;\r\n              }\r\n              \r\n              mm += resolution;\r\n            }\r\n          }\r\n        } \r\n\r\n        const finalCoor = pointToCoor(path.getPointAtLength(path.getTotalLength()));\r\n        out.push({ speed: getSpeed( out[out.length - 1].coor, finalCoor), coor: finalCoor });\r\n\r\n        return out;\r\n      }\r\n\r\n      // ---- Define functions to convert straight lines to motor moves ----\r\n      const getPulses = ({ actualLeftSteps, leftDirection, actualRightSteps, rightDirection, speeds }) => {\r\n        const mostSteps = Math.max(actualLeftSteps, actualRightSteps);\r\n\r\n        const leftModulus = actualLeftSteps === 0 ? 0 : mostSteps / actualLeftSteps;\r\n        const rightModulus = actualRightSteps === 0 ? 0 : mostSteps / actualRightSteps;\r\n\r\n        const out = new Array(mostSteps).fill(null).map(() => ({ s: 0, l: 0, r: 0 }));\r\n\r\n        if (speeds.current === speeds.top && speeds.top === speeds.eventual) {\r\n\r\n          // same speed all the way through\r\n          out.forEach(o => o.s = speeds.top);\r\n\r\n        } else if (speeds.current === speeds.top || speeds.top === speeds.eventual) {\r\n\r\n          // slowly ramp from speeds.current to speeds.eventual\r\n          const speedDiff = speeds.eventual - speeds.current;\r\n          const sign = speedDiff / Math.abs(speedDiff);\r\n          const blockSize = out.length / Math.abs(speedDiff);  \r\n\r\n          for (let i = 0; i < out.length; i++) {\r\n            out[i].s = (speeds.current + ( sign * Math.round(i / blockSize) ));\r\n          }\r\n\r\n        } else {\r\n\r\n          // ramp from speeds.current to speeds.top\r\n          // then from speeds.top to speeds.eventual\r\n          const halfway = Math.round(out.length / 2);\r\n\r\n          const firstBaseSpeed = speeds.current;\r\n          const firstSpeedDiff = speeds.top - firstBaseSpeed;\r\n          const firstSign = firstSpeedDiff / Math.abs(firstSpeedDiff);\r\n          const firstBlockSize = halfway / Math.abs(firstSpeedDiff);\r\n          for (let i = 0; i < halfway; i++) {\r\n            out[i].s = (firstBaseSpeed + ( firstSign * Math.round(i / firstBlockSize) ));\r\n          }\r\n\r\n          const secondBaseSpeed = (halfway > 0) ? out[halfway-1].s : speeds.current;\r\n          const secondSpeedDiff = speeds.eventual - secondBaseSpeed;\r\n          const secondSign = secondSpeedDiff / Math.abs(secondSpeedDiff);\r\n          const secondBlockSize = (out.length - halfway) / Math.abs(secondSpeedDiff);\r\n          for (let i = halfway; i < out.length; i++) {\r\n            out[i].s = (secondBaseSpeed + ( secondSign * Math.round((i - halfway) / secondBlockSize) ));\r\n          }\r\n\r\n        }\r\n\r\n        if (leftModulus > 0 && rightModulus > 0) {\r\n          let leftSum = 0;\r\n          let rightSum = 0;\r\n          for (let i = 0; i < mostSteps; i++) {\r\n            if (i >= leftSum) {\r\n              out[i].l = leftDirection;\r\n              leftSum += leftModulus;\r\n            }\r\n            if (i >= rightSum) {\r\n              out[i].r = rightDirection;\r\n              rightSum += rightModulus;\r\n            }\r\n          }\r\n        } else if (rightModulus <= 0) {\r\n          let leftSum = 0;\r\n          for (let i = 0; i < mostSteps; i++) {\r\n            if (i >= leftSum) {\r\n              out[i].l = leftDirection;\r\n              leftSum += leftModulus;\r\n            }\r\n          }\r\n        } else if (leftModulus <= 0) {\r\n          let rightSum = 0;\r\n          for (let i = 0; i < mostSteps; i++) {\r\n            if (i >= rightSum) {\r\n              out[i].r = rightDirection;\r\n              rightSum += rightModulus;\r\n            }\r\n          }\r\n        }\r\n\r\n        return out;\r\n      }\r\n\r\n      // euclidean distance\r\n      const eD = (a, b) => Math.sqrt(Math.pow(b.x - a.x, 2) + Math.pow(b.y - a.y, 2));\r\n\r\n      const mmPerStep = cmToMm(2 * Math.PI * specs['spool-radius'] * specs['step-resolution'] / 360);\r\n      const stepsPerMm = 1 / mmPerStep;\r\n\r\n      const traverseStraight = (current, desired, nextSpeed) => {\r\n        const currentLeftCoor = { x: current.coor.x - cmToMm(specs['tool-offset-x']), y: current.coor.y - cmToMm(specs['tool-offset-y'])};\r\n        const desiredLeftCoor = { x: desired.coor.x - cmToMm(specs['tool-offset-x']), y: desired.coor.y - cmToMm(specs['tool-offset-y'])};\r\n        const currentRightCoor = { x: current.coor.x + cmToMm(specs['tool-offset-x']), y: current.coor.y - cmToMm(specs['tool-offset-y'])};\r\n        const desiredRightCoor = { x: desired.coor.x + cmToMm(specs['tool-offset-x']), y: desired.coor.y - cmToMm(specs['tool-offset-y'])};\r\n\r\n        const leftDelta = eD({ x: 0, y: 0 }, desiredLeftCoor) - eD({ x: 0, y: 0 }, currentLeftCoor);\r\n        const rightDelta = eD({ x: cmToMm(specs['eye-to-eye']), y: 0 }, desiredRightCoor) - eD({ x: cmToMm(specs['eye-to-eye']), y: 0 }, currentRightCoor);\r\n\r\n        const actualLeftSteps = Math.round(Math.abs(leftDelta) * stepsPerMm);\r\n        const actualRightSteps = Math.round(Math.abs(rightDelta) * stepsPerMm);\r\n\r\n        // 1  = longer\r\n        // 0  = no op\r\n        // -1 = shorter\r\n        const leftDirection = actualLeftSteps === 0 ? 0 : leftDelta / Math.abs(leftDelta);\r\n        const rightDirection = actualRightSteps === 0 ? 0 : rightDelta / Math.abs(rightDelta);\r\n\r\n        const newLeftLength = eD({ x: 0, y: 0 }, currentLeftCoor) + (actualLeftSteps * mmPerStep * leftDirection);\r\n        const newRightLength = eD({ x: cmToMm(specs['eye-to-eye']), y: 0 }, currentRightCoor) + (actualRightSteps * mmPerStep * rightDirection);\r\n\r\n        const pulses = getPulses({\r\n          actualLeftSteps,\r\n          leftDirection,\r\n          actualRightSteps,\r\n          rightDirection,\r\n          speeds: {\r\n            current: current.speed,\r\n            top: desired.speed,\r\n            eventual: Math.min(desired.speed, nextSpeed)\r\n          }});\r\n\r\n        const newCurrent = {\r\n          speed: (!!pulses && pulses.length > 0)\r\n            ? pulses[pulses.length - 1].s\r\n            : current.speed,\r\n          coor: solveCoors({ \r\n            eyeToEye: cmToMm(specs['eye-to-eye']),\r\n            toolOffsetX: cmToMm(specs['tool-offset-x']),\r\n            toolOffsetY: cmToMm(specs['tool-offset-y']),\r\n            leftLength: newLeftLength,\r\n            rightLength: newRightLength\r\n          })\r\n        }\r\n\r\n        return { \r\n          pulses,\r\n          newCurrent\r\n        };\r\n      }\r\n\r\n      // ---- Gather all real-world coors we want to hit ----\r\n      const masterCoors = {};\r\n      masterCoors['start'] = ({ speed: 0, coor: { x: cmToMm(realCoors.outputRect.x), y: cmToMm(realCoors.outputRect.y) }});\r\n\r\n      let t1;\r\n      for (let i = 0; i < myPaths.length; i++) {\r\n        t1 = Date.now();\r\n\r\n        const key = `path-${i}`;\r\n        masterCoors[key] = pathToCoors(myPaths[i]);\r\n        \r\n        let t2 = Date.now();\r\n        await updateProgress(`path ${i} converted to coors (${t2-t1} ms)`);\r\n      }\r\n\r\n      // ---- Set missing speeds ----\r\n      for (let i = 0; i < myPaths.length; i++) {\r\n        const start = (i === 0)\r\n          ? masterCoors.start.coor\r\n          : masterCoors[`path-${i-1}`][masterCoors[`path-${i-1}`].length - 1].coor;\r\n        \r\n        const end = masterCoors[`path-${i}`][0];\r\n\r\n        masterCoors[`path-${i}`][0].speed = getSpeed( start, end );\r\n      }\r\n\r\n      // ---- Traverse all paths sequentially ----\r\n      let bigPulseList = [];\r\n\r\n      let current = masterCoors.start;\r\n      for (let i = 0; i < myPaths.length; i++) {\r\n        t1 = Date.now();\r\n      \r\n        for (let c = 0; c < masterCoors[`path-${i}`].length; c++) {\r\n          const nextSpeed = (c+1 >= masterCoors[`path-${i}`].length)\r\n            ? (i+1 >= myPaths.length)\r\n              ? 0\r\n              : masterCoors[`path-${i+1}`][0].speed\r\n            : masterCoors[`path-${i}`][c+1].speed;\r\n          const coor = masterCoors[`path-${i}`][c];\r\n          const { newCurrent, pulses } = traverseStraight(current, coor, nextSpeed);\r\n\r\n          if (!newCurrent.coor) {\r\n            return null;\r\n          }\r\n\r\n          current = newCurrent;\r\n          bigPulseList = [ ...bigPulseList, ...pulses ];\r\n        }\r\n\r\n        let t2 = Date.now();\r\n        await updateProgress(`path ${i} converted to pulses (${t2-t1} ms)`);\r\n      }\r\n\r\n      // get steps per second\r\n      const stepsPerSecond = () => {\r\n        const oneStep = specs['step-resolution'] / 360 * specs['spool-radius'] * 2 * Math.PI;\r\n        return 2.0 / oneStep; // ~ 2cm/s\r\n      }\r\n\r\n      const out = {\r\n        stepsPerSecond: stepsPerSecond(),\r\n        pulses: bigPulseList\r\n      };\r\n\r\n      setDownloadBlob(new Blob([JSON.stringify(out)], {type: 'text/plain'}));\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (downloadBlob) {\r\n      setDownloadHref(URL.createObjectURL(downloadBlob));\r\n    } else {\r\n      setDownloadHref('');\r\n    }\r\n  }, [downloadBlob]);\r\n  \r\n  return {\r\n    specErrors,\r\n    coorErrors,\r\n    ready: specsReady,\r\n    go,\r\n    downloadHref\r\n  };\r\n}","import React from 'react';\r\nimport { Button } from 'reactstrap';\r\n\r\nimport useConverter from './useConverter';\r\n\r\nconst Converter = () => {\r\n  const { specErrors, coorErrors, ready, go, downloadHref } = useConverter();\r\n\r\n  return (\r\n    <div className=\"row\">\r\n      <div className=\"col-12\">\r\n        <div className=\"my-2\">\r\n          {coorErrors \r\n            ? <span className=\"text-danger\">{coorErrors.msg}</span>\r\n            : specErrors \r\n              ? <span className=\"text-danger\">{specErrors.msg}</span>\r\n              : null\r\n          }\r\n        </div>\r\n      </div>\r\n      <div className=\"col-12\">\r\n        <Button disabled={!ready} onClick={go}>Calc motor control</Button>\r\n      </div>\r\n      <div className=\"col-12 my-3\">\r\n        {downloadHref !== '' && <a href={downloadHref} download=\"motorControl.json\">download</a>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Converter;","import React from 'react';\r\n\r\nimport usePreview from './usePreview';\r\n\r\nconst Preview = () => {\r\n  const { svg } = usePreview();\r\n\r\n  return (\r\n    <div className=\"mb-4\">\r\n      <div className=\"mb-2\">\r\n        <span>Preview</span>\r\n      </div>\r\n      <div className=\"d-flex\">\r\n        <div style={{ border: \"1px solid black\", height: \"402px\", minWidth: \"402px\", overflowY: \"scroll\" }}>\r\n          {svg}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default Preview;","import React, { useEffect, useState } from 'react';\r\nimport { useRecoilValue } from 'recoil';\r\n\r\nimport { realCoorsState } from '../Converter/state';\r\n\r\nexport default function usePreview() {\r\n  const coors = useRecoilValue(realCoorsState);\r\n  const [svg, setSvg] = useState(null);\r\n\r\n  const padding = 20;\r\n\r\n  useEffect(() => {\r\n    if (coors) {\r\n      const newSvg = (\r\n        <svg\r\n          version=\"1.1\"\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          width=\"400\"\r\n          viewBox={`-${padding} -${padding} ${coors.totalWidth + 2 * padding} ${coors.totalHeight + 2 * padding}`}>\r\n          <line \r\n            x1={coors.leftLine.start.x}\r\n            y1={coors.leftLine.start.y}\r\n            x2={coors.leftLine.end.x}\r\n            y2={coors.leftLine.end.y}\r\n            style={{ stroke: \"black\", strokeWidth: 1 }} />\r\n          <line \r\n            x1={coors.rightLine.start.x}\r\n            y1={coors.rightLine.start.y}\r\n            x2={coors.rightLine.end.x}\r\n            y2={coors.rightLine.end.y}\r\n            style={{ stroke: \"black\", strokeWidth: 1 }} />\r\n          <rect\r\n            x={coors.outputRect.x}\r\n            y={coors.outputRect.y}\r\n            width={coors.outputRect.width}\r\n            height={coors.outputRect.height}\r\n            style={{ fill: \"blue\" }} />\r\n          <circle\r\n            cx={coors.leftEye.x}\r\n            cy={coors.leftEye.y}\r\n            r={coors.spoolRadius}\r\n            fill=\"black\" />\r\n          <circle\r\n            cx={coors.rightEye.x}\r\n            cy={coors.rightEye.y}\r\n            r={coors.spoolRadius}\r\n            fill=\"black\" />\r\n        </svg>\r\n      )\r\n      setSvg(newSvg);\r\n    } else {\r\n      setSvg(null);\r\n    }\r\n  }, [coors]);\r\n\r\n  return { \r\n    svg\r\n  };\r\n}","import React from 'react';\r\n\r\nimport useConversionProgress from './useConversionProgress';\r\n\r\nconst ConversionProgress = () => {\r\n  const { progress } = useConversionProgress();\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"mb-2\">\r\n        <span>Progress</span>\r\n      </div>\r\n      <div className=\"d-flex\">\r\n        <div style={{ border: \"1px solid black\", height: \"402px\", width: \"402px\", overflowY: \"scroll\", padding: \"10px\" }}>\r\n          {progress.map(msg => <div key={msg}><span>&gt; {msg}</span></div>)}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ConversionProgress;","import { useRecoilValue } from 'recoil';\r\n\r\nimport { progressState } from '../Converter/state';\r\n\r\nexport default function useConversionProgress() {\r\n  const progress = useRecoilValue(progressState);\r\n\r\n  return {\r\n    progress\r\n  };\r\n}","import React from 'react';\r\nimport { RecoilRoot } from 'recoil';\r\n\r\nimport ImageHandler from './components/ImageHandler';\r\nimport SpecInputs from './components/SpecInputs';\r\nimport Converter from './components/Converter';\r\nimport Preview from './components/Preview';\r\nimport ConversionProgress from './components/ConversionProgress';\r\n\r\nimport './App.scss';\r\n\r\nfunction App() {\r\n  return (\r\n    <RecoilRoot>\r\n      <div className=\"container my-5\">\r\n        <div className=\"row\">\r\n          <div className=\"col-lg-6\">\r\n            <ImageHandler />\r\n            <Preview />\r\n            <ConversionProgress />\r\n          </div>\r\n          <div className=\"col-lg-6\">\r\n            <SpecInputs />\r\n            <Converter />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </RecoilRoot>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}