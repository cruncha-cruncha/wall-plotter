{"version":3,"sources":["components/ImageHandler/state/atoms.js","components/ImageHandler/ImageHandler.js","components/ImageHandler/useImageHandler.js","components/SpecInputs/state/atoms.js","components/SpecInputs/components/InputRow.js","components/SpecInputs/SpecInputs.js","components/SpecInputs/useSpecInputs.js","components/Converter/state/atoms.js","components/Converter/state/coorErrors.js","components/Converter/state/coorsReady.js","components/Converter/helpers/solveCoors.js","components/Converter/state/realCoors.js","components/Converter/state/specErrors.js","components/Converter/state/specsReady.js","components/Converter/Converter.js","components/Converter/useConverter.js","components/Preview/Preview.js","components/Preview/usePreview.js","components/ConversionProgress/ConversionProgress.js","components/ConversionProgress/useConversionProgress.js","App.js","reportWebVitals.js","index.js"],"names":["fileContentState","atom","key","default","ImageHandler","setFileContent","useSetRecoilState","useState","file","setFile","className","Label","for","Input","type","id","accept","onChange","e","newFile","URL","createObjectURL","target","files","reader","FileReader","onload","result","readAsText","style","border","height","minWidth","overflowY","src","width","alt","specsState","InputRow","label","actionType","specs","dispatch","step","value","payload","SpecInputs","useRecoilState","setSpecs","action","useSpecInputs","FormGroup","tag","check","checked","progressState","downloadBlobState","BOUNDS","upper","lower","coorErrorsState","selector","get","fileContent","specsAlpha","msg","Object","keys","reduce","out","k","Number","spec","coorsReadyState","solveCoors","eyeToEye","toolOffsetX","toolOffsetY","leftLength","rightLength","n1","n2","Math","pow","a","c","leftY2","sqrt","x","y","realCoorsState","ready","mmToCm","mm","dom","DOMParser","parseFromString","mySvg","Array","from","querySelectorAll","getAttribute","split","unitToMm","unit","spoolRadius","leftEye","rightEye","leftLine","start","end","rightLine","outputRect","totalWidth","totalHeight","coors","isNaN","rightY2","leftX2","rightX2","alert","specErrorsState","realCoors","specsReadyState","Converter","setProgress","useRecoilValue","specsReady","specErrors","coorErrors","downloadBlob","setDownloadBlob","downloadHref","setDownloadHref","cmToMm","cm","go","progress","updateProgress","push","Promise","resolve","setTimeout","parser","querySelector","myPaths","length","i","round","getTotalLength","mmToUnit","pointToCoor","point","distToLine","coorA","coorB","coorC","abs","pathToCoors","path","total","getPointAtLength","resolution","lag","precision","newCoor","getPulses","actualLeftSteps","leftDirection","actualRightSteps","rightDirection","mostSteps","max","leftModulus","rightModulus","fill","map","l","r","leftSum","rightSum","eD","b","mmPerStep","PI","stepsPerMm","traverseStraight","current","desired","currentLeftCoor","desiredLeftCoor","currentRightCoor","desiredRightCoor","leftDelta","rightDelta","newLeftLength","newRightLength","pulses","newCurrent","masterCoors","t1","Date","now","t2","bigPulseList","coor","Blob","JSON","stringify","useEffect","useConverter","Button","disabled","onClick","href","download","Preview","svg","setSvg","newSvg","version","xmlns","viewBox","x1","y1","x2","y2","stroke","strokeWidth","cx","cy","usePreview","ConversionProgress","padding","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.edfe2d31.chunk.js","sourcesContent":["import { atom } from 'recoil';\n\nexport const fileContentState = atom({\n  key: 'fileContents',\n  default: ''\n});","import React, { useState } from 'react';\nimport { Label, Input } from 'reactstrap';\n\nimport useImageHandler from './useImageHandler';\n\nfunction ImageHandler() {\n  const { setFileContent } = useImageHandler();\n  const [file, setFile] = useState(null);\n\n  const handleChange = (e) => {\n    const newFile = URL.createObjectURL(e.target.files[0]);\n    setFile(newFile);\n\n    const reader = new FileReader();\n    reader.onload = () => { setFileContent(reader.result); };\n    reader.readAsText(e.target.files[0]);\n  }\n\n  return (\n    <div className=\"mb-4\">\n      <div className=\"mb-3\">\n        <Label for=\"select-svg-input\">Select an SVG</Label>\n        <Input type=\"file\" id=\"select-svg-input\" accept=\".svg\" onChange={handleChange} />\n      </div>\n      <div className=\"d-flex\">\n        <div style={{ border: '1px solid black', height: \"402px\", minWidth: \"402px\", overflowY: \"scroll\" }} >\n          {file && <img src={file} width=\"400\" alt=\"selected img\" />}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default ImageHandler;","import { useSetRecoilState } from 'recoil';\n\nimport { fileContentState } from './state';\n\nexport default function useImageHandler() {\n  const setFileContent = useSetRecoilState(fileContentState);\n\n  return {\n    setFileContent\n  };\n}","import { atom } from 'recoil';\n\nexport const specsState = atom({\n  key: \"specs\",\n  default: {\n    'step-resolution': '1.8',\n    'final-height': '60',\n    'spool-radius': '2',\n    'eye-to-eye': '150',\n    'specify-start-by-coors': false,\n    'initial-length-left': '42',\n    'initial-length-right': '124',\n    'initial-coors-x': '30',\n    'initial-coors-y': '30',\n    'tool-offset-x': '2',\n    'tool-offset-y': '1.5'\n  }\n});","import React from 'react';\nimport { Label, Input } from 'reactstrap';\n\nconst InputRow = ({ label, actionType, specs, dispatch }) => {\n\n  const fV = (val) => val; //Number(val).toString();\n\n  return (\n    <div className=\"row mb-3\">\n      <div className=\"col-6 d-flex flex-row align-items-center\">\n        <Input id={actionType} type=\"number\" step=\"any\" value={fV(specs[actionType])} onChange={(e) => dispatch({ type: actionType, payload: e.target.value })} />\n      </div>\n      <div className=\"col-6 d-flex flex-row align-items-center\">\n        <Label for={actionType}>{label}</Label>\n      </div>\n    </div>\n  )\n}\n\nexport default InputRow;","import React, { Fragment } from 'react';\nimport { FormGroup, Label, Input } from 'reactstrap';\n\nimport useSpecInputs from './useSpecInputs';\nimport InputRow from './components/InputRow';\n\nconst SpecInputs = () => {\n\n  const { specs, dispatch } = useSpecInputs();\n\n  return (\n    <div className=\"specifications\">\n      <h2>Specifications</h2>\n      <p>All values in cms unless otherwise specified.</p>\n      <InputRow label=\"Step Resolution (degrees)\" actionType='step-resolution' specs={specs} dispatch={dispatch} />\n      <InputRow label=\"Output Height\" actionType='final-height' specs={specs} dispatch={dispatch} />\n      <InputRow label=\"Spool Radius\" actionType='spool-radius' specs={specs} dispatch={dispatch} />\n      <InputRow label=\"Eye-To-Eye\" actionType='eye-to-eye' specs={specs} dispatch={dispatch} />\n      <p>It's assumed that the plotter uses two strings, each with one end wound around a spool, travelling through an eye, and the other attached to a symmetrical tool holder. The program will start drawing from the upper-left corner of the image.</p>\n      <FormGroup tag=\"fieldset\">\n        <legend>Initial Position</legend>\n        <FormGroup check>\n          <Label check>\n            <Input\n              type=\"radio\"\n              onChange={() => dispatch({ type: 'specify-start-by-coors', payload: false })}\n              checked={!specs['specify-start-by-coors']}/>{' '}\n            Specify by distance from spools\n          </Label>\n        </FormGroup>\n        <FormGroup check>\n          <Label check>\n            <Input\n              type=\"radio\"\n              onChange={() => dispatch({ type: 'specify-start-by-coors', payload: true })}\n              checked={specs['specify-start-by-coors']}/>{' '}\n            Specify by horizontal and vertical offset\n          </Label>\n        </FormGroup>\n      </FormGroup>\n      {specs['specify-start-by-coors'] \n        ? (\n          <Fragment>\n            <p>Measure from the center of the left eye to the top left corner of the desired image location.</p>\n            <InputRow label=\"Horizontal Offset\" actionType='initial-coors-x' specs={specs} dispatch={dispatch} />\n            <InputRow label=\"Vertical Offset\" actionType='initial-coors-y' specs={specs} dispatch={dispatch} />\n          </Fragment>)\n        : (\n          <Fragment>\n            <p>Measure from either the left or right eye to the corresponding tool holder terminus (where the string connects).</p>\n            <InputRow label=\"Left, initial distance\" actionType='initial-length-left' specs={specs} dispatch={dispatch} />\n            <InputRow label=\"Right, initial distance\" actionType='initial-length-right' specs={specs} dispatch={dispatch} />\n          </Fragment>)}\n      <p>The left terminus is assumed to be above and to the left of the tool, while the right terminus is assumed to be above and to the right of the tool. \"Horizontal Terminus Offset\" is the horizontal distance between a terminus and the tool tip (it should be the same for both termini); \"Vertical Terminus Offset\" is the vertical distance between a terminus and the tool tip (should also be the same for both).</p>\n      <InputRow label=\"Horizontal Terminus Offset\" actionType='tool-offset-x' specs={specs} dispatch={dispatch} />\n      <InputRow label=\"Vertical Terminus Offset\" actionType='tool-offset-y' specs={specs} dispatch={dispatch} />\n    </div>\n  )\n}\n\nexport default SpecInputs;","import { useRecoilState } from 'recoil';\n\nimport { specsState } from './state';\n\nexport default function useSpecInputs() {\n  const [ specs, setSpecs ] = useRecoilState(specsState);\n\n  const dispatch = (action) => {\n    setSpecs({\n      ...specs,\n      [action.type]: action.payload\n    });\n  }\n\n  return {\n    specs,\n    dispatch\n  }\n}","import { atom } from 'recoil';\n\nexport const progressState = atom({\n  key: 'progress',\n  default: []\n});\n\nexport const downloadBlobState = atom({\n  key: 'downloadBload',\n  default: null\n})","import { selector } from 'recoil';\n\nimport { fileContentState } from '../../ImageHandler/state';\nimport { specsState } from '../../SpecInputs/state';\n\nexport const BOUNDS = {\n  'final-height': {\n    upper: 1000,\n    lower: 1\n  },\n  'eye-to-eye': {\n    upper: 1000,\n    lower: 1\n  },\n  'spool-radius': {\n    upper: 25,\n    lower: 0\n  },\n  'initial-length-left': {\n    upper: 1000,\n    lower: 0\n  },\n  'initial-length-right': {\n    upper: 1000,\n    lower: 0\n  },\n  'initial-coors-x': {\n    upper: 1000,\n    lower: 0\n  },\n  'initial-coors-y': {\n    upper: 1000,\n    lower: 0\n  },\n  'tool-offset-x': {\n    upper: 50,\n    lower: 0\n  },\n  'tool-offset-y': {\n    upper: 50,\n    lower: 0\n  }\n}\n\nexport const coorErrorsState = selector({\n  key: 'coorErrors',\n  get: ({get}) => {\n    const fileContent = get(fileContentState);\n    const specsAlpha = get(specsState);\n\n    // do we have a file and specs?\n    if (!fileContent || !specsAlpha) {\n      return { msg: 'No image' };\n    }\n\n    const specs = Object.keys(specsAlpha).reduce((out, k) => ({\n      ...out,\n      [k]: Number(specsAlpha[k])\n    }), {});\n\n    // have spec values been entered?\n    for (let k of Object.keys(BOUNDS)) {\n      if (!(k in specs)) {\n        return { spec: k, msg: `Missing ${k} specification` };\n      }\n    }\n\n    // are all spec values within a reasonable range? (lower bounds)\n    for (let k of Object.keys(BOUNDS)) {\n      if (specs[k] > BOUNDS[k].upper) {\n        return { spec: k, msg: `${k} is too high; max is ${BOUNDS[k].upper}` };\n      } else if (specs[k] < BOUNDS[k].lower) {\n        return { spec: k, msg: `${k} is too low; minimum is ${BOUNDS[k].lower}` };\n      }\n    }\n\n    // is the initial position physically valid?\n    if (specs['specify-start-by-coors']) {\n      if (\n        specs['initial-coors-x'] +\n        (specs['tool-offset-x'] * 2) >\n        specs['eye-to-eye']\n      ) {\n        return { msg: 'Specs are not physically valid' };\n      }\n    }\n\n    return null;\n  },\n});","import { selector } from 'recoil';\n\nimport { coorErrorsState } from './coorErrors';\n\nexport const coorsReadyState = selector({\n  key: 'coorsReady',\n  get: ({get}) => {\n    const errors = get(coorErrorsState);\n    return !errors;\n  },\n});","// eyeToEye = sqrt(leftLength^2 - y^2) + (toolOffsetX * 2) + sqrt(rightLength^2 - y^2)\n// solve for y\n\nexport default function solveCoors({ eyeToEye, toolOffsetX, toolOffsetY, leftLength, rightLength }) {\n  if (eyeToEye <= 0 || toolOffsetX < 0 || toolOffsetY < 0 || leftLength < 0 || rightLength < 0) {\n    return null;\n  }\n\n  const n1 = eyeToEye - (toolOffsetX * 2);\n  const n2 = Math.pow(rightLength, 2) - Math.pow(leftLength, 2) - Math.pow(n1, 2);\n\n  const a = 4 * Math.pow(n1, 2);\n  // b is always zero\n  const c = -4 * Math.pow(n1, 2) * Math.pow(leftLength, 2) + Math.pow(n2, 2);\n\n  const leftY2 = Math.sqrt(-4 * a * c) / (2 * a);\n  const leftX2 = Math.sqrt(Math.pow(leftLength, 2) - Math.pow(leftY2, 2));\n\n  return {\n    x: leftX2 + toolOffsetX,\n    y: leftY2 + toolOffsetY\n  };\n}","import { selector } from 'recoil';\n\nimport { fileContentState } from '../../ImageHandler/state';\nimport { specsState } from '../../SpecInputs/state';\nimport { coorsReadyState } from './coorsReady';\n\nimport solveCoors from '../helpers/solveCoors';\n\nexport const realCoorsState = selector({\n  key: 'realCoors',\n  get: ({get}) => {\n    const ready = get(coorsReadyState);\n    const specsAlpha = get(specsState);\n    const fileContent = get(fileContentState);\n\n    if (!ready) {\n      return null;\n    }\n\n    const specs = Object.keys(specsAlpha).reduce((out, k) => ({\n      ...out,\n      [k]: Number(specsAlpha[k])\n    }), {});\n\n    const mmToCm = (mm) => mm / 10;\n    const cmToMm = (cm) => cm * 10;\n\n    const parser = new DOMParser();\n    const dom = parser.parseFromString(fileContent, \"application/xml\");\n\n    const mySvg = Array.from(dom.querySelectorAll(\"svg\"))[0];\n    if (!mySvg.getAttribute(\"viewBox\")) {\n      alert(\"SVG needs a viewBox\");\n      return;\n    }\n\n    const [_minX, _minY, width, height] = mySvg.getAttribute(\"viewBox\").split(\" \");\n\n    const unitToMm = (unit) => unit * cmToMm(specs[\"final-height\"]) / height;\n\n    if (specs['specify-start-by-coors']) {\n      return {\n        spoolRadius: specs['spool-radius'],\n        leftEye: { x: 0, y: 0 },\n        rightEye: { x: specs['eye-to-eye'], y: 0 },\n        leftLine: {\n          start: { x: 0, y: 0 },\n          end: {\n            x: specs['initial-coors-x'] - specs['tool-offset-x'],\n            y: specs['initial-coors-y'] - specs['tool-offset-y'] }\n        },\n        rightLine: {\n          start: { x: specs['eye-to-eye'], y: 0 },\n          end: {\n            x: specs['initial-coors-x'] + specs['tool-offset-x'],\n            y: specs['initial-coors-y'] - specs['tool-offset-y']\n          }\n        },\n        outputRect: {\n          x: specs['initial-coors-x'],\n          y: specs['initial-coors-y'],\n          width: mmToCm(unitToMm(width)),\n          height: mmToCm(unitToMm(height))\n        },\n        totalWidth: specs['eye-to-eye'],\n        totalHeight: specs['initial-coors-y'] + mmToCm(unitToMm(height))\n      }\n    } else {\n      const coors = solveCoors({\n        eyeToEye: specs['eye-to-eye'],\n        toolOffsetX: specs['tool-offset-x'],\n        toolOffsetY: specs['tool-offset-y'],\n        leftLength: specs['initial-length-left'],\n        rightLength: specs['initial-length-right'],\n      });\n\n      if (!coors) {\n        return null;\n      }\n\n      if (isNaN(coors.x) || isNaN(coors.y)) {\n        return null;\n      }\n\n      const leftY2 = coors.y - specs['tool-offset-y'];\n      const rightY2 = leftY2;\n      const leftX2 = coors.x - specs['tool-offset-x'];\n      const rightX2 = coors.x + specs['tool-offset-x'];\n\n      return {\n        spoolRadius: specs['spool-radius'],\n        leftEye: { x: 0, y: 0 },\n        rightEye: { x: specs['eye-to-eye'], y: 0 },\n        leftLine: {\n          start: { x: 0, y: 0 },\n          end: { x: leftX2, y: leftY2 }\n        },\n        rightLine: {\n          start: { x: specs['eye-to-eye'], y: 0 },\n          end: { x: rightX2, y: rightY2 }\n        },\n        outputRect: {\n          x: leftX2 + specs['tool-offset-x'],\n          y: leftY2 + specs['tool-offset-y'],\n          width: mmToCm(unitToMm(width)),\n          height: mmToCm(unitToMm(height))\n        },\n        totalWidth: specs['eye-to-eye'],\n        totalHeight: leftY2 + specs['tool-offset-y'] + mmToCm(unitToMm(height))\n      }\n    } \n  }\n});","import { selector } from 'recoil';\n\nimport { specsState } from '../../SpecInputs/state';\nimport { realCoorsState } from './realCoors';\n\nexport const BOUNDS = {\n  'step-resolution': {\n    upper: 45,\n    lower: 0.01\n  },\n}\n\nexport const specErrorsState = selector({\n  key: 'specErrors',\n  get: ({get}) => {\n    const realCoors = get(realCoorsState);\n    const specsAlpha = get(specsState);\n\n    if (!realCoors) {\n      return { msg: 'Specs are not physically valid' };\n    } else if (realCoors.outputRect.x + realCoors.outputRect.width > realCoors.rightEye.x) {\n      return { msg: 'Can\\'t draw outside vertical bounds of eyes' };\n    }\n\n    const specs = Object.keys(specsAlpha).reduce((out, k) => ({\n      ...out,\n      [k]: Number(specsAlpha[k])\n    }), {});\n\n    // have spec values been entered?\n    for (let k of Object.keys(BOUNDS)) {\n      if (!(k in specs)) {\n        return { spec: k, msg: `Missing ${k} specification` };\n      }\n    }\n\n    // are all spec values within a reasonable range? (lower bounds)\n    for (let k of Object.keys(BOUNDS)) {\n      if (specs[k] > BOUNDS[k].upper) {\n        return { spec: k, msg: `${k} is too high; max is ${BOUNDS[k].upper}` };\n      } else if (specs[k] < BOUNDS[k].lower) {\n        return { spec: k, msg: `${k} is too low; minimum is ${BOUNDS[k].lower}` };\n      }\n    }\n\n    return null;\n  },\n});","import { selector } from 'recoil';\n\nimport { specErrorsState } from './specErrors';\n\nexport const specsReadyState = selector({\n  key: 'specsReady',\n  get: ({get}) => {\n    const errors = get(specErrorsState);\n    return !errors;\n  },\n});","import React from 'react';\nimport { Button } from 'reactstrap';\n\nimport useConverter from './useConverter';\n\nconst Converter = () => {\n  const { specErrors, coorErrors, ready, go, downloadHref } = useConverter();\n\n  return (\n    <div className=\"row\">\n      <div className=\"col-12\">\n        <div className=\"my-2\">\n          {coorErrors \n            ? <span className=\"text-danger\">{coorErrors.msg}</span>\n            : specErrors \n              ? <span className=\"text-danger\">{specErrors.msg}</span>\n              : null\n          }\n        </div>\n      </div>\n      <div className=\"col-12\">\n        <Button disabled={!ready} onClick={go}>Calc motor control</Button>\n      </div>\n      <div className=\"col-12 my-3\">\n        {downloadHref !== '' && <a href={downloadHref} download=\"motorControl.json\">download</a>}\n      </div>\n    </div>\n  );\n}\n\nexport default Converter;","import { useState, useEffect } from 'react';\nimport { useRecoilState, useRecoilValue, useSetRecoilState } from 'recoil';\n\nimport { fileContentState } from '../ImageHandler/state';\nimport { specsState } from '../SpecInputs/state';\nimport { progressState, specErrorsState, specsReadyState, coorErrorsState, realCoorsState, downloadBlobState } from './state';\n\nimport solveCoors from './helpers/solveCoors';\n\nexport default function useConverter() {\n  const setProgress = useSetRecoilState(progressState);\n  const specsAlpha = useRecoilValue(specsState);\n  const fileContent = useRecoilValue(fileContentState);\n  const specsReady = useRecoilValue(specsReadyState);\n  const specErrors = useRecoilValue(specErrorsState);\n  const coorErrors = useRecoilValue(coorErrorsState);\n  const realCoors = useRecoilValue(realCoorsState);\n  const [downloadBlob, setDownloadBlob] = useRecoilState(downloadBlobState);\n  const [downloadHref, setDownloadHref] = useState('');\n  \n  const mmToCm = (mm) => mm / 10;\n  const mmToM = (mm) => mm / 1000;\n  const cmToMm = (cm) => cm * 10;\n  const cmToM = (cm) => cm / 100;\n  const mToMm = (m) => m * 1000;\n  const mToCm = (m) => m * 100;\n\n  const go = async () => {\n    if (specsReady) {\n      const specs = Object.keys(specsAlpha).reduce((out, k) => ({\n        ...out,\n        [k]: Number(specsAlpha[k])\n      }), {});\n\n      setProgress([]);\n      const progress = [];\n      const updateProgress = async (msg) => {\n        progress.push(msg);\n        setProgress([ ...progress ]);\n        // give progress a chance to propogate\n        await new Promise((resolve) => setTimeout(resolve, 0));\n      }\n\n      // ---- Get SVG, it's dimensions and paths ----\n      const parser = new DOMParser();\n      const dom = parser.parseFromString(fileContent, \"application/xml\");\n\n      const mySvg = dom.querySelector(\"svg\");\n      const [_minX, _minY, _width, height] = mySvg.getAttribute(\"viewBox\").split(\" \");\n\n      // in future, also get: circle, ellipse, line, mesh, path, polygon, polyline, rect?\n      const myPaths = Array.from(dom.querySelectorAll(\"path\"));\n      await updateProgress(`Found ${myPaths.length} paths, of lengths:`);\n      for (let i = 0; i < myPaths.length; i++) {\n        await updateProgress(`${i}: ${Math.round(myPaths[i].getTotalLength() * 100) / 100}`);\n      }     \n      \n      // ---- Define functions for converting SVG coors into real-world coors ----\n      const unitToMm = (unit) => unit * cmToMm(specs[\"final-height\"]) / height;\n      const mmToUnit = (mm) => mm * height / cmToMm(specs[\"final-height\"]);\n\n      const pointToCoor = (point) => ({\n        x: cmToMm(realCoors.outputRect.x) + unitToMm(point.x),\n        y: cmToMm(realCoors.outputRect.y) + unitToMm(point.y)\n      });\n\n      // how far away is coorB from a line passing through coorA and coorC\n      const distToLine = (coorA, coorB, coorC) => {\n        return (\n          Math.abs((coorC.x - coorA.x) * (coorA.y - coorB.y) - (coorA.x - coorB.x) * (coorC.y - coorA.y)) /\n          Math.sqrt(Math.pow((coorC.x - coorA.x), 2) + Math.pow((coorC.y - coorA.y), 2))\n        );\n      }\n\n      const pathToCoors = (path) => {\n        const out = [];\n        const total = unitToMm(path.getTotalLength());\n\n        // use 2mm output resolution\n        const resolution = 2;\n\n        out.push(\n          pointToCoor(\n            path.getPointAtLength(0)));\n\n        if (total > resolution) {\n\n          out.push(\n            pointToCoor(\n              path.getPointAtLength(\n                mmToUnit(resolution))));\n\n          if (total > resolution * 2) {\n            let lag = 0;\n            let mm = resolution * 2; \n            let precision = resolution;\n\n            while (mm < total) {\n              const newCoor = pointToCoor(path.getPointAtLength(mmToUnit(mm)))\n              const dist = distToLine(out[lag], out[lag+1], newCoor);\n\n              if (dist < precision) {\n                out[lag+1] = newCoor;\n                precision = precision / 2;\n              } else {\n                lag += 1;\n                out.push(newCoor);\n                precision = resolution;\n              }\n              \n              mm += resolution;\n            }\n          }\n        } \n\n        out.push(pointToCoor(path.getPointAtLength(path.getTotalLength())));\n\n        return out;\n      }\n\n      // ---- Define functions to convert straight lines to motor moves ----\n      const getPulses = ({ actualLeftSteps, leftDirection, actualRightSteps, rightDirection }) => {\n        const mostSteps = Math.max(actualLeftSteps, actualRightSteps);\n\n        const leftModulus = actualLeftSteps === 0 ? 0 : mostSteps / actualLeftSteps;\n        const rightModulus = actualRightSteps === 0 ? 0 : mostSteps / actualRightSteps;\n\n        const out = new Array(mostSteps).fill(null).map(() => ({ l: 0, r: 0 }));\n\n        if (leftModulus > 0 && rightModulus > 0) {\n          let leftSum = 0;\n          let rightSum = 0;\n          for (let i = 0; i < mostSteps; i++) {\n            if (i >= leftSum) {\n              out[i].l = leftDirection;\n              leftSum += leftModulus;\n            }\n            if (i >= rightSum) {\n              out[i].r = rightDirection;\n              rightSum += rightModulus;\n            }\n          }\n        } else if (rightModulus <= 0) {\n          let leftSum = 0;\n          for (let i = 0; i < mostSteps; i++) {\n            if (i >= leftSum) {\n              out[i].l = leftDirection;\n              leftSum += leftModulus;\n            }\n          }\n        } else if (leftModulus <= 0) {\n          let rightSum = 0;\n          for (let i = 0; i < mostSteps; i++) {\n            if (i >= rightSum) {\n              out[i].r = rightDirection;\n              rightSum += rightModulus;\n            }\n          }\n        }\n\n        return out;\n      }\n\n      // euclidean distance\n      const eD = (a, b) => Math.sqrt(Math.pow(b.x - a.x, 2) + Math.pow(b.y - a.y, 2));\n\n      const mmPerStep = cmToMm(2 * Math.PI * specs['spool-radius'] * specs['step-resolution'] / 360);\n      const stepsPerMm = 1 / mmPerStep;\n\n      const traverseStraight = (current, desired) => {\n        const currentLeftCoor = { x: current.x - cmToMm(specs['tool-offset-x']), y: current.y - cmToMm(specs['tool-offset-y'])};\n        const desiredLeftCoor = { x: desired.x - cmToMm(specs['tool-offset-x']), y: desired.y - cmToMm(specs['tool-offset-y'])};\n        const currentRightCoor = { x: current.x + cmToMm(specs['tool-offset-x']), y: current.y - cmToMm(specs['tool-offset-y'])};\n        const desiredRightCoor = { x: desired.x + cmToMm(specs['tool-offset-x']), y: desired.y - cmToMm(specs['tool-offset-y'])};\n\n        const leftDelta = eD({ x: 0, y: 0 }, desiredLeftCoor) - eD({ x: 0, y: 0 }, currentLeftCoor);\n        const rightDelta = eD({ x: cmToMm(specs['eye-to-eye']), y: 0 }, desiredRightCoor) - eD({ x: cmToMm(specs['eye-to-eye']), y: 0 }, currentRightCoor);\n\n        const actualLeftSteps = Math.round(Math.abs(leftDelta) * stepsPerMm);\n        const actualRightSteps = Math.round(Math.abs(rightDelta) * stepsPerMm);\n\n        // 1  = longer\n        // 0  = no op\n        // -1 = shorter\n        const leftDirection = actualLeftSteps === 0 ? 0 : leftDelta / Math.abs(leftDelta);\n        const rightDirection = actualRightSteps === 0 ? 0 : rightDelta / Math.abs(rightDelta);\n\n        const newLeftLength = eD({ x: 0, y: 0 }, currentLeftCoor) + (actualLeftSteps * mmPerStep * leftDirection);\n        const newRightLength = eD({ x: cmToMm(specs['eye-to-eye']), y: 0 }, currentRightCoor) + (actualRightSteps * mmPerStep * rightDirection);\n\n        return { \n          pulses: getPulses({ actualLeftSteps, leftDirection, actualRightSteps, rightDirection }),\n          newCurrent: solveCoors({ \n            eyeToEye: cmToMm(specs['eye-to-eye']),\n            toolOffsetX: cmToMm(specs['tool-offset-x']),\n            toolOffsetY: cmToMm(specs['tool-offset-y']),\n            leftLength: newLeftLength,\n            rightLength: newRightLength\n          })\n        };\n      }\n\n      // ---- Gather all real-world coors we want to hit ----\n      const masterCoors = {};\n      masterCoors['start'] = { x: cmToMm(realCoors.outputRect.x), y: cmToMm(realCoors.outputRect.y) };\n\n      let t1;\n      for (let i = 0; i < myPaths.length; i++) {\n        t1 = Date.now();\n\n        const key = `path-${i}`;\n        masterCoors[key] = pathToCoors(myPaths[i]);\n        \n        let t2 = Date.now();\n        await updateProgress(`path ${i} converted to coors (${t2-t1} ms)`);\n      }\n\n      // ---- Traverse all paths sequentially ----\n      let bigPulseList = [];\n\n      let current = masterCoors.start;\n      for (let i = 0; i < myPaths.length; i++) {\n        t1 = Date.now();\n      \n        for (let coor of masterCoors[`path-${i}`]) {\n          const { newCurrent, pulses } = traverseStraight(current, coor);\n\n          if (!newCurrent) {\n            return null;\n          }\n\n          current = newCurrent;\n          bigPulseList = [ ...bigPulseList, ...pulses ];\n        }\n\n        let t2 = Date.now();\n        await updateProgress(`path ${i} converted to pulses (${t2-t1} ms)`);\n      }\n\n      setDownloadBlob(new Blob([JSON.stringify(bigPulseList)], {type: 'text/plain'}));\n    }\n  }\n\n  useEffect(() => {\n    if (downloadBlob) {\n      setDownloadHref(URL.createObjectURL(downloadBlob));\n    }\n  }, [downloadBlob]);\n  \n  return {\n    specErrors,\n    coorErrors,\n    ready: specsReady,\n    go,\n    downloadHref\n  };\n}","import React from 'react';\n\nimport usePreview from './usePreview';\n\nconst Preview = () => {\n  const { svg } = usePreview();\n\n  return (\n    <div className=\"mb-4\">\n      <div className=\"mb-2\">\n        <span>Preview</span>\n      </div>\n      <div className=\"d-flex\">\n        <div style={{ border: \"1px solid black\", height: \"402px\", minWidth: \"402px\", overflowY: \"scroll\" }}>\n          {svg}\n        </div>\n      </div>\n    </div>\n  )\n};\n\nexport default Preview;","import React, { useEffect, useState } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { realCoorsState } from '../Converter/state';\n\nexport default function usePreview() {\n  const coors = useRecoilValue(realCoorsState);\n  const [svg, setSvg] = useState(null);\n\n  const padding = 20;\n\n  useEffect(() => {\n    if (coors) {\n      const newSvg = (\n        <svg\n          version=\"1.1\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          width=\"400\"\n          viewBox={`-${padding} -${padding} ${coors.totalWidth + 2 * padding} ${coors.totalHeight + 2 * padding}`}>\n          <line \n            x1={coors.leftLine.start.x}\n            y1={coors.leftLine.start.y}\n            x2={coors.leftLine.end.x}\n            y2={coors.leftLine.end.y}\n            style={{ stroke: \"black\", strokeWidth: 1 }} />\n          <line \n            x1={coors.rightLine.start.x}\n            y1={coors.rightLine.start.y}\n            x2={coors.rightLine.end.x}\n            y2={coors.rightLine.end.y}\n            style={{ stroke: \"black\", strokeWidth: 1 }} />\n          <rect\n            x={coors.outputRect.x}\n            y={coors.outputRect.y}\n            width={coors.outputRect.width}\n            height={coors.outputRect.height}\n            style={{ fill: \"blue\" }} />\n          <circle\n            cx={coors.leftEye.x}\n            cy={coors.leftEye.y}\n            r={coors.spoolRadius}\n            fill=\"black\" />\n          <circle\n            cx={coors.rightEye.x}\n            cy={coors.rightEye.y}\n            r={coors.spoolRadius}\n            fill=\"black\" />\n        </svg>\n      )\n      setSvg(newSvg);\n    } else {\n      setSvg(null);\n    }\n  }, [coors]);\n\n  return { \n    svg\n  };\n}","import React from 'react';\n\nimport useConversionProgress from './useConversionProgress';\n\nconst ConversionProgress = () => {\n  const { progress } = useConversionProgress();\n\n  return (\n    <div>\n      <div className=\"mb-2\">\n        <span>Progress</span>\n      </div>\n      <div className=\"d-flex\">\n        <div style={{ border: \"1px solid black\", height: \"402px\", width: \"402px\", overflowY: \"scroll\", padding: \"10px\" }}>\n          {progress.map(msg => <div key={msg}><span>&gt; {msg}</span></div>)}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default ConversionProgress;","import { useRecoilValue } from 'recoil';\n\nimport { progressState } from '../Converter/state';\n\nexport default function useConversionProgress() {\n  const progress = useRecoilValue(progressState);\n\n  return {\n    progress\n  };\n}","import React from 'react';\nimport { RecoilRoot } from 'recoil';\n\nimport ImageHandler from './components/ImageHandler';\nimport SpecInputs from './components/SpecInputs';\nimport Converter from './components/Converter';\nimport Preview from './components/Preview';\nimport ConversionProgress from './components/ConversionProgress';\n\nimport './App.scss';\n\nfunction App() {\n  return (\n    <RecoilRoot>\n      <div className=\"container my-5\">\n        <div className=\"row\">\n          <div className=\"col-lg-6\">\n            <ImageHandler />\n            <Preview />\n            <ConversionProgress />\n          </div>\n          <div className=\"col-lg-6\">\n            <SpecInputs />\n            <Converter />\n          </div>\n        </div>\n      </div>\n    </RecoilRoot>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nimport 'bootstrap/dist/css/bootstrap.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}